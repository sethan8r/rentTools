<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="https://www.thymeleaf.org/extras/spring-security">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>RenTool - –ì–ª–∞–≤–Ω–∞—è</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    body {
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    .navbar {
      background-color: #2c3e50;
      padding: 1rem 2rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    .nav-left {
      display: flex;
      align-items: center;
    }

    .logo {
      height: 60px;
      margin-right: 2rem;
      transition: transform 0.3s;
    }

    .logo:hover {
      transform: scale(1.05);
    }

    .nav-links {
      display: flex;
      list-style: none;
    }

    .nav-links li {
      margin-right: 1.5rem;
    }

    .nav-links a {
      color: #ecf0f1;
      text-decoration: none;
      font-weight: 500;
      padding: 0.5rem 0.8rem;
      border-radius: 4px;
      transition: background-color 0.3s;
    }

    .nav-links a:hover {
      background-color: rgba(255, 255, 255, 0.1);
    }

    .nav-right {
      display: flex;
      align-items: center;
    }

    .auth-buttons a {
      color: #ecf0f1;
      text-decoration: none;
      font-weight: 500;
      padding: 0.5rem 1rem;
      border-radius: 4px;
      margin-left: 1rem;
      transition: background-color 0.3s;
    }

    .login-btn {
      background-color: #4a90e2;
    }

    .login-btn:hover {
      background-color: #3a7bc8;
    }

    .profile-btn {
      background-color: #27ae60;
    }

    .profile-btn:hover {
      background-color: #219653;
    }

    .logout-btn {
      background-color: #e74c3c;
    }

    .logout-btn:hover {
      background-color: #c0392b;
    }

    .catalog-btn-container {
      background-color: #4a90e2;
      padding: 1rem 0;
      text-align: center;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    .catalog-btn {
      background-color: #27ae60;
      color: white;
      text-decoration: none;
      padding: 1rem 2rem;
      border-radius: 8px;
      font-weight: 600;
      font-size: 1.2rem;
      transition: all 0.3s;
      display: inline-block;
    }

    .catalog-btn:hover {
      background-color: #219653;
      transform: translateY(-2px);
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    }

    .container {
      flex: 1;
      width: 100%;
      max-width: 1200px;
      margin: 0 auto;
      padding: 2rem;
    }

    .welcome-section {
      text-align: center;
      margin-bottom: 3rem;
    }

    .welcome-section h1 {
      font-size: 3rem;
      color: #2c3e50;
      margin-bottom: 1rem;
      text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
    }

    .welcome-section p {
      font-size: 1.2rem;
      color: #7f8c8d;
      max-width: 800px;
      margin: 0 auto;
      line-height: 1.6;
    }

    .tools-section {
      margin-bottom: 3rem;
      position: relative;
    }

    .tools-section h2 {
      text-align: center;
      font-size: 2.5rem;
      color: #2c3e50;
      margin-bottom: 2rem;
      padding-bottom: 0.5rem;
      border-bottom: 3px solid #4a90e2;
      display: inline-block;
    }

    .carousel-container {
      position: relative;
      overflow: hidden;
      width: 100%;
      margin: 2rem 0;
    }

    .carousel-track {
      display: flex;
      transition: transform 0.5s ease-in-out;
      gap: 2rem;
    }

    .tool-card {
      background-color: white;
      border-radius: 15px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
      overflow: hidden;
      transition: transform 0.3s, box-shadow 0.3s;
      flex: 0 0 280px;
      position: relative;
    }

    .tool-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 40px rgba(0, 0, 0, 0.2);
    }

    .tool-image-container {
      width: 100%;
      height: 280px;
      display: flex;
      align-items: center;
      justify-content: center;
      background-color: #f8f9fa;
      border-bottom: 2px solid #eee;
    }

    .tool-image {
      max-width: 100%;
      max-height: 100%;
      object-fit: contain;
    }

    .tool-info {
      padding: 1.5rem;
    }

    .tool-name {
      font-size: 1.2rem;
      color: #2c3e50;
      margin-bottom: 0.5rem;
      font-weight: 600;
      height: 3rem;
      overflow: hidden;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
    }

    .tool-type {
      color: #7f8c8d;
      font-size: 0.9rem;
      margin-bottom: 1rem;
      font-style: italic;
    }

    .tool-price {
      font-size: 1.5rem;
      color: #27ae60;
      font-weight: 700;
      margin-bottom: 1rem;
    }

    .tool-availability {
      position: absolute;
      top: 1rem;
      right: 1rem;
      padding: 0.3rem 0.8rem;
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: 600;
      z-index: 2;
    }

    .available {
      background-color: #27ae60;
      color: white;
    }

    .unavailable {
      background-color: #e74c3c;
      color: white;
    }

    .carousel-controls {
      display: flex;
      justify-content: center;
      gap: 1rem;
      margin-top: 2rem;
    }

    .carousel-btn {
      background-color: #4a90e2;
      color: white;
      border: none;
      padding: 0.8rem 1.5rem;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 600;
      transition: background-color 0.3s;
    }

    .carousel-btn:hover {
      background-color: #3a7bc8;
    }

    .loading {
      text-align: center;
      font-size: 1.2rem;
      color: #7f8c8d;
      margin: 2rem 0;
    }

    .features-section {
      background-color: white;
      border-radius: 15px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
      padding: 3rem 2rem;
      margin-bottom: 3rem;
    }

    .features-section h2 {
      text-align: center;
      font-size: 2.5rem;
      color: #2c3e50;
      margin-bottom: 2rem;
    }

    .features-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 2rem;
    }

    .feature-item {
      text-align: center;
      padding: 1.5rem;
    }

    .feature-icon {
      font-size: 3rem;
      color: #4a90e2;
      margin-bottom: 1rem;
    }

    .feature-title {
      font-size: 1.3rem;
      color: #2c3e50;
      margin-bottom: 1rem;
      font-weight: 600;
    }

    .feature-description {
      color: #7f8c8d;
      line-height: 1.6;
    }

    .footer {
      background-color: #2c3e50;
      color: #ecf0f1;
      text-align: center;
      padding: 1.5rem;
      margin-top: auto;
    }

    @media (max-width: 768px) {
      .navbar {
        flex-direction: column;
        padding: 1rem;
      }

      .nav-left {
        margin-bottom: 1rem;
      }

      .nav-links {
        margin-bottom: 1rem;
        flex-wrap: wrap;
        justify-content: center;
      }

      .nav-links li {
        margin: 0.5rem;
      }

      .welcome-section h1 {
        font-size: 2rem;
      }

      .welcome-section p {
        font-size: 1rem;
      }

      .tool-card {
        flex: 0 0 250px;
      }

      .tool-image-container {
        height: 250px;
      }

      .catalog-btn {
        padding: 0.8rem 1.5rem;
        font-size: 1rem;
      }
    }
  </style>
</head>
<body>
<nav class="navbar">
  <div class="nav-left">
    <a href="/">
      <img src="/RenTool.png" alt="–õ–æ–≥–æ—Ç–∏–ø RenTool" class="logo">
    </a>
    <ul class="nav-links">
      <li><a href="/catalog">–ö–∞—Ç–∞–ª–æ–≥</a></li>
      <li><a href="/order/all">–ó–∞–∫–∞–∑—ã</a></li>
      <li><a href="/about">–û –∫–æ–º–ø–∞–Ω–∏–∏</a></li>
    </ul>
  </div>
  <div class="nav-right">
    <div class="auth-buttons">
      <a href="/login" class="login-btn" sec:authorize="!isAuthenticated()">–í–æ–π—Ç–∏</a>
      <a href="/profile" class="profile-btn" sec:authorize="isAuthenticated()">–ü—Ä–æ—Ñ–∏–ª—å</a>
      <a href="/logout" class="logout-btn" sec:authorize="isAuthenticated()">–í—ã–π—Ç–∏</a>
    </div>
  </div>
</nav>

<div class="catalog-btn-container">
  <a href="/catalog" class="catalog-btn">–ü–µ—Ä–µ–π—Ç–∏ –≤ –∫–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤</a>
</div>

<div class="container">
  <div class="welcome-section">
    <h1>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ RenTool!</h1>
    <p>–í–∞—à –Ω–∞–¥–µ–∂–Ω—ã–π –ø–∞—Ä—Ç–Ω–µ—Ä –≤ –º–∏—Ä–µ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ –∏ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è. –ú—ã –ø—Ä–µ–¥–ª–∞–≥–∞–µ–º —à–∏—Ä–æ–∫–∏–π –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç —Ç–æ–≤–∞—Ä–æ–≤ –¥–ª—è –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª–æ–≤ –∏ –ª—é–±–∏—Ç–µ–ª–µ–π.</p>
  </div>

  <div class="tools-section">
    <h2>–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã</h2>

    <div class="carousel-container">
      <div class="carousel-track" id="carousel-track">
        <div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤...</div>
      </div>
    </div>
  </div>

  <div class="features-section">
    <h2>–ü–æ—á–µ–º—É –≤—ã–±–∏—Ä–∞—é—Ç –Ω–∞—Å?</h2>
    <div class="features-grid">
      <div class="feature-item">
        <div class="feature-icon">üöö</div>
        <h3 class="feature-title">–ë—ã—Å—Ç—Ä–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞</h3>
        <p class="feature-description">–î–æ—Å—Ç–∞–≤–ª—è–µ–º –∑–∞–∫–∞–∑—ã –ø–æ –≤—Å–µ–π —Å—Ç—Ä–∞–Ω–µ –≤ –∫—Ä–∞—Ç—á–∞–π—à–∏–µ —Å—Ä–æ–∫–∏</p>
      </div>
      <div class="feature-item">
        <div class="feature-icon">‚≠ê</div>
        <h3 class="feature-title">–ì–∞—Ä–∞–Ω—Ç–∏—è –∫–∞—á–µ—Å—Ç–≤–∞</h3>
        <p class="feature-description">–í—Å–µ —Ç–æ–≤–∞—Ä—ã –ø—Ä–æ—Ö–æ–¥—è—Ç —Å—Ç—Ä–æ–≥–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å –∫–∞—á–µ—Å—Ç–≤–∞</p>
      </div>
      <div class="feature-item">
        <div class="feature-icon">üîß</div>
        <h3 class="feature-title">–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥</h3>
        <p class="feature-description">–ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ –æ—Ç –æ–ø—ã—Ç–Ω—ã—Ö —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤</p>
      </div>
      <div class="feature-item">
        <div class="feature-icon">üí≥</div>
        <h3 class="feature-title">–£–¥–æ–±–Ω–∞—è –æ–ø–ª–∞—Ç–∞</h3>
        <p class="feature-description">–†–∞–∑–ª–∏—á–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã –æ–ø–ª–∞—Ç—ã –¥–ª—è –≤–∞—à–µ–≥–æ —É–¥–æ–±—Å—Ç–≤–∞</p>
      </div>
    </div>
  </div>
</div>

<div class="footer">
  <p>¬© 2023 RenTool. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
</div>

<script>
  let allTools = [];
  let currentPosition = 0;
  let carouselInterval;
  const carouselSpeed = 200; // 3 —Å–µ–∫—É–Ω–¥—ã –º–µ–∂–¥—É –ø—Ä–æ–∫—Ä—É—Ç–∫–∞–º–∏

  // –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
  document.addEventListener('DOMContentLoaded', () => {
    loadTools();
  });

  // –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤
  async function loadTools() {
    try {
      const response = await fetch('/api/tool/get/all?page=0&size=20&sort=name');
      if (response.ok) {
        const data = await response.json();
        allTools = data.content || [];
        displayTools();
        startCarousel();
      } else {
        document.getElementById('carousel-track').innerHTML = '<div class="loading">–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ç–æ–≤–∞—Ä–æ–≤</div>';
      }
    } catch (error) {
      document.getElementById('carousel-track').innerHTML = '<div class="loading">–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ç–æ–≤–∞—Ä–æ–≤</div>';
    }
  }

  // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∫–∞—Ä—É—Å–µ–ª–∏
  function displayTools() {
    const carouselTrack = document.getElementById('carousel-track');

    if (allTools.length === 0) {
      carouselTrack.innerHTML = '<div class="loading">–¢–æ–≤–∞—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</div>';
      return;
    }

    carouselTrack.innerHTML = '';

    // –î—É–±–ª–∏—Ä—É–µ–º —Ç–æ–≤–∞—Ä—ã –¥–ª—è –±–µ—Å—à–æ–≤–Ω–æ–π –ø—Ä–æ–∫—Ä—É—Ç–∫–∏
    const duplicatedTools = [...allTools, ...allTools];

    duplicatedTools.forEach(tool => {
      const toolCard = document.createElement('div');
      toolCard.className = 'tool-card';

      toolCard.innerHTML = `
                <div class="tool-availability ${tool.isAvailable ? 'available' : 'unavailable'}">
                    ${tool.isAvailable ? '–í –Ω–∞–ª–∏—á–∏–∏' : '–ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏'}
                </div>
                <div class="tool-image-container">
                    <img src="${tool.picture.url}" alt="${tool.name}" class="tool-image" onerror="this.src='https://via.placeholder.com/800x800?text=–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ+–Ω–µ+–∑–∞–≥—Ä—É–∂–µ–Ω–æ'">
                </div>
                <div class="tool-info">
                    <h3 class="tool-name">${tool.name}</h3>
                    <p class="tool-type">${tool.type}</p>
                    <p class="tool-price">${formatPrice(tool.price)} ‚ÇΩ</p>
                </div>
            `;

      carouselTrack.appendChild(toolCard);
    });
  }

  // –ó–∞–ø—É—Å–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∫–∞—Ä—É—Å–µ–ª–∏
  function startCarousel() {
    if (allTools.length <= 1) return;

    const carouselTrack = document.getElementById('carousel-track');
    const cardWidth = 280 + 32; // —à–∏—Ä–∏–Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–∏ + gap
    const totalWidth = cardWidth * allTools.length;

    // –°–±—Ä–æ—Å –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞
    if (carouselInterval) {
      clearInterval(carouselInterval);
    }

    carouselInterval = setInterval(() => {
      currentPosition -= 1;

      // –ï—Å–ª–∏ –¥–æ—à–ª–∏ –¥–æ –∫–æ–Ω—Ü–∞, –ø–ª–∞–≤–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –≤ –Ω–∞—á–∞–ª–æ
      if (Math.abs(currentPosition) >= totalWidth) {
        currentPosition = 0;
        carouselTrack.style.transition = 'none';
        carouselTrack.style.transform = `translateX(${currentPosition}px)`;

        // –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è —Å–±—Ä–æ—Å–∞ –∞–Ω–∏–º–∞—Ü–∏–∏
        setTimeout(() => {
          carouselTrack.style.transition = 'transform 0.5s ease-in-out';
        }, 50);
      } else {
        carouselTrack.style.transition = 'transform 0.5s ease-in-out';
        carouselTrack.style.transform = `translateX(${currentPosition}px)`;
      }
    }, carouselSpeed / 5); // –ú–µ–¥–ª–µ–Ω–Ω–∞—è –ø–ª–∞–≤–Ω–∞—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∞
  }

  // –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–∞—Ä—É—Å–µ–ª–∏ –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏
  document.getElementById('carousel-track').addEventListener('mouseenter', () => {
    if (carouselInterval) {
      clearInterval(carouselInterval);
    }
  });

  // –í–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞—Ä—É—Å–µ–ª–∏ –ø—Ä–∏ —É—Ö–æ–¥–µ –∫—É—Ä—Å–æ—Ä–∞
  document.getElementById('carousel-track').addEventListener('mouseleave', () => {
    startCarousel();
  });

  // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ü–µ–Ω—ã
  function formatPrice(price) {
    return new Intl.NumberFormat('ru-RU').format(price);
  }

  // –û—á–∏—Å—Ç–∫–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
  window.addEventListener('beforeunload', () => {
    if (carouselInterval) {
      clearInterval(carouselInterval);
    }
  });
</script>
</body>
</html>